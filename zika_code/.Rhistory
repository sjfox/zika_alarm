trials <- run_branches(num_reps = 1000, prop_p, recov_p, incub_p, prob_symp,
d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate)
lastvalues <- all_last_cuminfect_values(trials)
hist(lastvalues, main = paste( "1000 Runs, R0 =", prop_p/recov_p, sep = ""), breaks = 10, ylim = c(1,1000))
prop_p <- 1.9/7
trials <- run_branches(num_reps = 1000, prop_p, recov_p, incub_p, prob_symp,
d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate)
lastvalues <- all_last_cuminfect_values(trials)
hist(lastvalues, main = paste( "1000 Runs, R0 =", prop_p/recov_p, sep = ""), breaks = 10, ylim = c(1,1000))
prop_p <- 2.1/7
trials <- run_branches(num_reps = 1000, prop_p, recov_p, incub_p, prob_symp,
d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate)
lastvalues <- all_last_cuminfect_values(trials)
hist(lastvalues, main = paste( "1000 Runs, R0 =", prop_p/recov_p, sep = ""), breaks = 10, ylim = c(1,1000))
prop_p <- 1.7/7
trials <- run_branches(num_reps = 1000, prop_p, recov_p, incub_p, prob_symp,
d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate)
escape_prob <- c(escapes)
escapes = 0
escape_prob <- c(escapes)
prob_ext <- function(prop_p, recov_p, incub_p, prob_symp, d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate, nsamples=100) {
escapes = 0
escape_prob <- c(escapes)
i = 1
while (i < nsamples) {
record = run_branch(prop_p, recov_p, incub_p, prob_symp, d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate) #Run the simulation
Final.I = record[nrow(record),7]
Final.D = record[nrow(record),6]
if (Final.D < d_thres)  {
next
}
if (Final.I > e_thresh) {
escapes = escapes + 1
}
escapes_prob <- c(escapes_prob, escapes/i)
i = i+1
}
}
prob_ext <- function(prop_p, recov_p, incub_p, prob_symp, d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate, nsamples=100) {
escapes = 0
escape_prob <- c(escapes)
i = 1
while (i < nsamples) {
record = run_branch(prop_p, recov_p, incub_p, prob_symp, d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate) #Run the simulation
Final.I = record[nrow(record),7]
Final.D = record[nrow(record),6]
if (Final.D < d_thres)  {
next
}
if (Final.I > e_thresh) {
escapes = escapes + 1
}
escapes_prob <- c(escapes_prob, escapes/i)
i = i+1
}
return(escapes_prob)
}
escape_prob <- prob_ext(prop_p = prop_p,recov_p = recov_p, incub_p = incub_p, prob_symp = prob_symp,
d_thres,e_thresh = e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate, nsamples=1000)
prob_ext <- function(prop_p, recov_p, incub_p, prob_symp, d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate, nsamples=100) {
escapes = 0
escapes_prob <- c(escapes)
i = 1
while (i < nsamples) {
record = run_branch(prop_p, recov_p, incub_p, prob_symp, d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate) #Run the simulation
Final.I = record[nrow(record),7]
Final.D = record[nrow(record),6]
if (Final.D < d_thres)  {
next
}
if (Final.I > e_thresh) {
escapes = escapes + 1
}
escapes_prob <- c(escapes_prob, escapes/i)
i = i+1
}
return(escapes_prob)
}
escape_prob <- prob_ext(prop_p = prop_p,recov_p = recov_p, incub_p = incub_p, prob_symp = prob_symp,
d_thres,e_thresh = e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate, nsamples=1000)
hist(escape_prob)
hist(escape_prob, breaks = 10)
hist(escape_prob, breaks = 10, ylim = c(0,200))
hist(escape_prob[200:1000], breaks = 10)
d_thres <- 10
escape_prob <- prob_ext(prop_p = prop_p,recov_p = recov_p, incub_p = incub_p, prob_symp = prob_symp,
d_thres,e_thresh = e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate, nsamples=1000)
hist(escape_prob[200:1000], breaks = 10, main = "d_thres = 10")
prob_underD.overE <- function(prop_p, recov_p, incub_p, prob_symp, d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate, nsamples=10) {
escapes = 0
escapes_prob <- c(escapes)
i = 1
while (i < nsamples) {
record = run_branch(prop_p, recov_p, incub_p, prob_symp, d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate) #Run the simulation
Final.I = record[nrow(record),7]
Final.D = record[nrow(record),6]
if (Final.D < d_thres)  { # Haven't Crossed Detection
if (Final.I > e_thresh) { # Is my Instantaneous Number of Infections more than my epidemic
escapes = escapes + 1
escapes_prob <- c(escapes_prob, escapes/i)
}
}
i = i+1
}
return(escapes_prob)
}
escape_underDoverE <- prob_underD.overE(prop_p = prop_p,recov_p = recov_p, incub_p = incub_p, prob_symp = prob_symp,
d_thres,e_thresh = e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate, nsamples=10)
escape_underDoverE
d_thres <- 5
escape_underDoverE <- prob_underD.overE(prop_p = prop_p,recov_p = recov_p, incub_p = incub_p, prob_symp = prob_symp,
d_thres,e_thresh = e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate, nsamples=10)
escape_underDoverE
trials <- run_branches(num_reps = 10, prop_p, recov_p, incub_p, prob_symp,
d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate)
last_instantInf_value <- function(x) {
row <- tail(x, 1)
value <- row[7]
return(value)
}
all_last_instantInf_values <- function(x) {
return(unlist(laply(trials, last_cumdetect_value)))
}
last_infected <- all_last_instantInf_values(trials)
last_infected
trials <- run_branches(num_reps = 100, prop_p, recov_p, incub_p, prob_symp,
d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate)
last_infected <- all_last_instantInf_values(trials)
last_infected
lastvalues <- all_last_cuminfect_values(trials)
lastvalues
plot(last_infected, lastvalues)
d_thres <- 5
e_thresh <- 150
trials <- run_branches(num_reps = 1000, prop_p, recov_p, incub_p, prob_symp,
d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate)
last_infected <- all_last_instantInf_values(trials)
hist(last_infected)
trials <- run_branches(num_reps = 10, prop_p, recov_p, incub_p, prob_symp,
d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate)
trials
x = trials
x = trials[1]
row <- tail(x, 1)
value <- row[7]
value
x = trials[[1]]
View(x)
row <- tail(x, 1)
value <- row[7]
value
all_last_instantInf_values <- function(x) {
return(unlist(laply(trials, last_instantInf_value)))
}
last_infected <- all_last_instantInf_values(trials)
hist(last_infected)
trials <- run_branches(num_reps = 1000, prop_p, recov_p, incub_p, prob_symp,
d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate)
last_infected <- all_last_instantInf_values(trials)
hist(last_infected)
e_thresh <- 100
trials <- run_branches(num_reps = 1000, prop_p, recov_p, incub_p, prob_symp,
d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate)
last_infected <- all_last_instantInf_values(trials)
hist(last_infected)
e_thresh <- 60
trials <- run_branches(num_reps = 1000, prop_p, recov_p, incub_p, prob_symp,
d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate)
last_infected <- all_last_instantInf_values(trials)
hist(last_infected)
e_thresh <- 30
trials <- run_branches(num_reps = 1000, prop_p, recov_p, incub_p, prob_symp,
d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate)
last_infected <- all_last_instantInf_values(trials)
hist(last_infected)
lastvalues <- all_last_cuminfect_values(trials)
lastvalues
plot(lastvalues, last_infected)
plot(last_infected, lastvalues)
e_thresh <- 25
trials <- run_branches(num_reps = 1000, prop_p, recov_p, incub_p, prob_symp,
d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate)
last_infected <- all_last_instantInf_values(trials)
hist(last_infected)
lastvalues <- all_last_cuminfect_values(trials)
hist(lastvalues, main = paste( "1000 Runs, R0 =", prop_p/recov_p, sep = ""), breaks = 10, ylim = c(1,1000))
plot(lastvalues, last_infected)
plot(last_infected, last_values)
plot(last_infected, lastvalues)
last_infected
e_thresh <- 100
d_thres <- 5
d_thres <- 10
escape_underDoverE <- prob_underD.overE(prop_p = prop_p,recov_p = recov_p, incub_p = incub_p, prob_symp = prob_symp,
d_thres,e_thresh = e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate, nsamples=10)
escape_underDoverE <- prob_underD.overE(prop_p = prop_p,recov_p = recov_p, incub_p = incub_p, prob_symp = prob_symp,
d_thres,e_thresh = e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate, nsamples=100)
escape_underDoverE
escape_prob <- prob_ext(prop_p = prop_p,recov_p = recov_p, incub_p = incub_p, prob_symp = prob_symp,
d_thres,e_thresh = e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate, nsamples=1000)
escape_prob
d_thres <- 20
escape_prob <- prob_ext(prop_p = prop_p,recov_p = recov_p, incub_p = incub_p, prob_symp = prob_symp,
d_thres,e_thresh = e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate, nsamples=1000)
escape_prob
d_thres <- 5
escape_prob <- prob_ext(prop_p = prop_p,recov_p = recov_p, incub_p = incub_p, prob_symp = prob_symp,
d_thres,e_thresh = e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate, nsamples=1000)
escape_prob
x
last_detect <- last_detect(x)
last_detect <- last_cumdetect_value(x)
last_detect > d_thres
more_than_detect <- function(x, d_thres) {
last_detect <- last_cumdetect_value(x)
if (last_detect > d_thres) x = 1
return
}
more_than_detect(x, d_thers)
more_than_detect(x, d_thres)
more_than_detect <- function(x, d_thres) {
last_detect <- last_cumdetect_value(x)
x = 0
if (last_detect > d_thres) x = 1
return (x)
}
more_than_detect(x, d_thres)
more_than_detect <- function(x, d_thres) {
last_detect <- last_cumdetect_value(x)
x = 0
if (last_detect >= d_thres) x = 1
return (x)
}
more_than_detect_boolean <- function(x, d_thres) {
last_detect <- last_cumdetect_value(x)
x = 0
if (last_detect >= d_thres) x = 1
return (x)
}
indicator <- (unlist(laply(trials, more_than_detect_boolean(trials, d_thres))
indicator <- (unlist(laply(trials, more_than_detect_boolean(trials, d_thres)))
indicator <- (unlist(laply(trials, more_than_detect_boolean(trials, d_thres))))
laply(trials, more_than_detect_boolean(trials, d_thres))
more_than_detect_boolean <- function(x, d_thres) {
last_detect <- last_cumdetect_value(x)
x = 0
if (last_detect >= d_thres) x = 1
return (x)
}
x = trials[3]
x
x = trials[4]
x
x = trials[5]
x
d_thres <- 5
e_thresh <- 150
trials <- run_branches(num_reps = 1000, prop_p, recov_p, incub_p, prob_symp,
d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate)
x = trials[5]
x
x = trials[4]
x
x = trials[6]
x
last_detect <- last_cumdetect_value(x)
last_detect
last_cumdetect_value <- function(x) {
row <- tail(x, 1)
value <- row[6]
return(value)
}
last_detect <- last_cumdetect_value(x)
last_detect
last_detect <- unlist(last_cumdetect_value(x))
last_detect <- unlist(last_cumdetect_value(x))
last_detect
last_cumdetect_value(x)
x <- trials[[4]]
x
last_detect <- unlist(last_cumdetect_value(x))
x = 0
if (last_detect >= d_thres) x = 1
return (x)
more_than_detect_boolean <- function(x, d_thres) {
last_detect <- unlist(last_cumdetect_value(x))
x = 0
if (last_detect >= d_thres) x = 1
return (x)
}
more_than_deteect_boolean(trials[[4]], d_thres)
more_than_detect_boolean(trials[[4]], d_thres)
more_than_detect_boolean(trials[[5]], d_thres)
more_than_detect_boolean(trials[[6]], d_thres)
more_than_detect_boolean <- function(x, d_thres) {
last_detect <- unlist(last_cumdetect_value(x))
x = 0
if (last_detect >= d_thres) x = 1
return (x)
}
indicator <- (unlist(laply(trials, more_than_detect_boolean(trials, d_thres))))
laply(trials, more_than_detect_boolean(trials, d_thres)))
laply(trials, more_than_detect_boolean(trials, d_thres))
more_than_detect_boolean <- function(x, d_thres) {
last_detect <- last_cumdetect_value(x)
x = 0
if (last_detect >= d_thres) x = 1
return (x)
}
more_than_detect_boolean(trials[[4]], d_thers)
more_than_detect_boolean(trials[[4]], d_thres)
more_than_detect_boolean <- function(x, d_thres) {
last_detect <- last_cumdetect_value(x)
x = 0
if (last_detect >= d_thres) x = 1
return (x)
}
indicator <- (unlist(laply(trials, more_than_detect_boolean(trials, d_thres))))
laply(trials, more_than_detect_boolean(trials, d_thres)))
indicator < laply(trials, more_than_detect_boolean(trials, d_thres))
indicator <- laply(trials, more_than_detect_boolean(trials, d_thres))
trials[[1]]
x = trials[[6]]
rows <- x[x[,6 = d_thres],]
rows <- x[x[ ,6 == d_thres],]
x
X[,6]
x[,6]
x[, d_thres]
x, [,6]
detections <- x[,6]
detections[detections == d_thres]
detections <- x[,6]
rows <- detections[detections == d_thres]
rows <- which(detections[detections == d_thres])
detections[detections == d_thres]
rows <- which(detections == d_thres)
x <- x[rows,]
x
detection_rows <- function(x, d_thres) {
detections <- x[,6]
rows <- which(detections == d_thres)
x <- x[rows,]
return(x)
}
x <- trials[[7]]
detection_rows(x, d_thres)
all_detect_rows <- function(x, d_thres) {
return(unlist(ldply(trials, detection_rows)))
}
all_detect_rows(x, d_thres)
all_detect_rows <- function(x, d_thres) {
return(unlist(ldply(trials, detection_rows(d_thres = d_thres,...))))
}
all_detect_rows(x, d_thres)
all_detect_rows <- function(x, d_thres) {
return(unlist(ldply(x, detection_rows(x, d_thres))))
}
all_detect_rows(x, d_thres)
all_detect_rows <- function(x, d_thres) {
return(unlist(ldply(x, detection_rows(x, d_thres))))
}
all_detect_rows(trials, d_thres)
x <- trails[[1]]
x <- trials[[1]]
detections <- x[,6]
reduced <- x[rows,]
x
detections <- x[,6]
detections
rows <- which(detections == d_thres)
reduced <- x[rows,]
reduced
all_detect_rows <- function(x, d_thres) {
return(unlist(ldply(x, detection_rows(x, d_thres))))
}
all_detect_rows(trials, d_thres)
all_last_cumdetect_values <- function(x) {
return(unlist(laply(x, last_cumdetect_value)))
}
last_cumdetect_value <- function(x) {
row <- tail(x, 1)
value <- row[6]
return(value)
}
last_detected <- all_last_cumdetect_valeus(trials)
last_detected <- all_last_cumdetect_values(trials)
x <- trial[1]
x <- trails[1]
x <- trials[1]
x
tail(x)
tail(x,1)
x[,6]
x <- x[1]
x
x <- x[[1]]
x
detection_rows <- function(x, d_thres) {
x <- x[[1]]
detections <- x[,6]
rows <- which(detections == d_thres)
reduced <- x[rows,]
return(reduced)
}
detection_rows(x, d_thres)
nrow(x)
nrow(x) ; ncol(x)
detections <- x[,6]
detection_rows <- function(x, d_thres) {
nrow(x) ; ncol(x)
rows <- which(detections == d_thres)
reduced <- x[rows,]
return(reduced)
}
all_detect_rows <- function(x, d_thres) {
return(unlist(ldply(x, detection_rows(x, d_thres))))
}
all_detect_rows(trials, d_thres)
all_detect_rows <- function(x, d_thres) {
return(unlist(ldply(x, detection_rows)))
}
all_detect_rows(trials, d_thres)
detection_rows <- function(x, d_thres = d_thres) {
detections <- x[,6]
rows <- which(detections == d_thres)
reduced <- x[rows,]
return(reduced)
}
all_detect_rows(trials, d_thres)
all_detect_rows(trials, d_thres)
x <- trials[[7]]
detections <- x[,6]
rows <- which(detections == d_thres)
d_thres
reduced <- x[rows,]
detection_rows <- function(x, d_thres = d_thres) {
detections <- x[,6]
rows <- which(detections == d_thres)
reduced <- x[rows,]
return(reduced)
}
detection_rows(x, d_thres)
all_detect_rows <- function(x) {
return(ldply(x, detection_rows))
}
all_detect_rows(trials, d_thres)
all_detect_rows(trials)
detection_rows <- function(x, d_thres) {
detections <- x[,6]
rows <- which(detections == d_thres)
reduced <- x[rows,]
return(reduced)
}
detection_rows(x, d_thres)
all_detect_rows <- function(x) {
return(ldply(x, detection_rows))
}
all_detect_rows(trials)
all_detect_rows <- function(x, d_thres) {
return(ldply(x, detection_rows(d_thres)))
}
all_detect_rows(trials)
all_detect_rows <- function(x, d_thres) {
return(ldply(x, detection_rows(d_thres = d_thres)))
}
all_detect_rows(trials)
all_detect_rows <- function(x, d_thres) {
return(ldply(x, detection_rows))
}
all_detect_rows(trials)
detection_rows <- function(x, d_thres=5) {
detections <- x[,6]
rows <- which(detections == d_thres)
reduced <- x[rows,]
return(reduced)
}
all_detect_rows(trials)
at.detect <- all_detect_rows(trials)
average(at.detect$Total_Infected)
mean(at.detect$Total_Infected)
mean(at.detect$Cumulative_Infections)
detection_rows <- function(x, detect_thres=d_thres) {
detections <- x[,6]
rows <- which(detections == detect_thres)
reduced <- x[rows,]
return(reduced)
}
at.detect <- all_detect_rows(trials)
trials <- run_branches(num_reps = 1000, prop_p, recov_p, incub_p, prob_symp,
d_thres, e_thresh, dis_prob_asymp, dis_prob_symp, intro_rate)
at.detect <- all_detect_rows(trials)
thousand.total_Infected <- mean(at.detect$Total_Infected)
thoustand.cum_Infected <- mean(at.detect$Cumulative_Infections)
thousand.total_Infected_5 <- mean(at.detect$Total_Infected)
thousand.total_Infected_5 <- mean(at.detect$Total_Infected)
thoustand.cum_Infected_5 <- mean(at.detect$Cumulative_Infections)
d_thres <- 10
at.detect <- all_detect_rows(trials)
thousand.total_Infected_10 <- mean(at.detect$Total_Infected)
thoustand.cum_Infected_10 <- mean(at.detect$Cumulative_Infections)
d_thres <- 15
at.detect <- all_detect_rows(trials)
thousand.total_Infected_15 <- mean(at.detect$Total_Infected)
thousand.cum_Infected_15 <- mean(at.detect$Cumulative_Infections)
d_thres <- 20
at.detect <- all_detect_rows(trials)
thousand.total_Infected_20 <- mean(at.detect$Total_Infected)
thousand.cum_Infected_20 <- mean(at.detect$Cumulative_Infections)
total.infected <- cbind(thousand.total_Infected_5, thousand.total_Infected_10, thousand.total_Infected_15, thousand.total_Infected_20)
threshold <- cbind(5, 10, 15, 20)
plot(threshold, total.infected)
